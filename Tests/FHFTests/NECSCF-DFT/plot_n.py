import matplotlib.pyplot as plt
import numpy
from pyscf import gto
from NECSCF.Nuclear import geom


mol=gto.Mole()
mol.atom = [['F',(0, 0, -1.4)],
            ['H',(0, 0, -0.0)],
            ['F',(0, 0, 1.4)]]
mol.basis = 'def2-SVP'
mol.charge = -1
mol.spin = 0
mol.build()

N = 120
NQ = 60
Q = geom.switch_geom(mol)
step = 0.01*1.88972612
v = 0
DisVector = numpy.array([[0.00000, 0.00000, -0.00000],
                      [0.00000, 0.00000,  1.00000],
                      [0.00000, 0.00000,  0.00000]])

Geom_k = numpy.array(geom.geom_gen(Q, DisVector, N, NQ, step/1.88972612))
HF_distance = Geom_k[:, 1, 2] + 1.4


nuc_wfn_lastv0 =  numpy.array([-0.01217388-3.57008726e-26j, -0.02506342-3.79413574e-08j,
 -0.04058757-1.77003887e-08j, -0.05799209-4.99396696e-08j,
 -0.07750297-8.26567184e-08j, -0.09903767-8.42527515e-08j,
 -0.12337631-1.64230863e-07j, -0.15123882-1.04446964e-07j,
 -0.18221796-4.95333099e-07j, -0.21680935-8.72560747e-07j,
 -0.25422401-1.03800042e-06j, -0.29377288-9.08193249e-07j,
 -0.33586795-8.71865700e-07j, -0.37941661-9.18127516e-07j,
 -0.42444672-1.19121484e-06j, -0.47114271-1.03906274e-06j,
 -0.51884396-1.69714759e-06j, -0.56697396+6.47946344e-07j,
 -0.61440927+3.27965045e-06j, -0.66047297+2.98856184e-06j,
 -0.70459261+3.33406696e-06j, -0.74617991+4.55170624e-06j,
 -0.7845898 +6.51128146e-06j, -0.81976238+6.30275242e-06j,
 -0.85128677+7.20371748e-06j, -0.87872419+6.83342482e-06j,
 -0.90179615+7.22874411e-06j, -0.92038781+7.05778260e-06j,
 -0.93451485+7.47892037e-06j, -0.94427153+7.23529000e-06j,
 -0.94976033+7.60107460e-06j, -0.95116355+7.25705015e-06j,
 -0.9487216 +7.65137448e-06j, -0.94272642+6.66274450e-06j,
 -0.93351328+6.19264600e-06j, -0.92142081+5.98370953e-06j,
 -0.90681141+6.09426238e-06j, -0.89007328+5.71313075e-06j,
 -0.87163042+5.91804344e-06j, -0.85180393+5.36006189e-06j,
 -0.83093369+5.84109979e-06j, -0.80929928+3.66734527e-06j,
 -0.78720735+2.13189974e-06j, -0.76503436+1.56044958e-06j,
 -0.74306597+7.04883355e-07j, -0.72155498+9.20282349e-07j,
 -0.70072906+1.23193920e-06j, -0.68078102+2.11619271e-08j,
 -0.66189167-9.68329301e-07j, -0.64420029-1.51350497e-06j,
 -0.6277996 -2.53730249e-06j, -0.6128696 -2.15189740e-06j,
 -0.59945346-2.29762606e-06j, -0.58765384-2.29761090e-06j,
 -0.57754274-2.63943581e-06j, -0.56917141-2.42415025e-06j,
 -0.56259004-2.53952282e-06j, -0.55781772-2.40367769e-06j,
 -0.55486695-2.49565665e-06j, -0.55375529-2.40409340e-06j,
 -0.55448426-2.49112083e-06j, -0.55705205-2.43195547e-06j,
 -0.56144296-2.52336517e-06j, -0.56763778-2.48768883e-06j,
 -0.5755976 -2.59330459e-06j, -0.58529043-2.56451797e-06j,
 -0.5966623 -2.72153402e-06j, -0.60965079-2.39879822e-06j,
 -0.62417575-2.07571970e-06j, -0.64013901-2.23602760e-06j,
 -0.65740446-2.21304810e-06j, -0.67592234-2.37998487e-06j,
 -0.69545605-2.29159808e-06j, -0.71594427-2.91076724e-06j,
 -0.73716258-2.76350920e-06j, -0.75877072-1.90688905e-06j,
 -0.78063186-2.31302667e-06j, -0.80244223-2.07928549e-06j,
 -0.82387864-2.47020593e-06j, -0.84463537-2.04941331e-06j,
 -0.8643548 -3.95279774e-06j, -0.88262533-5.81548497e-06j,
 -0.89909395-5.54281564e-06j, -0.91344276-5.79991376e-06j,
 -0.92529111-5.66299334e-06j, -0.93426082-5.84723617e-06j,
 -0.9400258 -5.73131718e-06j, -0.94226369-5.63385541e-06j,
 -0.94068965-5.75380888e-06j, -0.93507243-5.39961471e-06j,
 -0.92522448-7.08982437e-06j, -0.91101801-8.42588097e-06j,
 -0.89238014-9.22187050e-06j, -0.86937648-1.17231041e-05j,
 -0.84213813-1.01781019e-05j, -0.81097188-1.08124431e-05j,
 -0.7761998 -9.42551177e-06j, -0.73784578-8.74965301e-06j,
 -0.69622478-3.97783979e-06j, -0.65214234-1.27773357e-05j,
 -0.60654482-1.86048759e-05j, -0.56004807-1.65901326e-05j,
 -0.51329581-1.43996239e-05j, -0.46646786-1.99663251e-05j,
 -0.42007326-2.58731622e-05j, -0.37476262-2.07626594e-05j,
 -0.33159473-2.06642269e-05j, -0.29087587-1.89941670e-05j,
 -0.25254352-1.81555201e-05j, -0.21684345-1.45653524e-05j,
 -0.18396354-1.28847328e-05j, -0.15376778-5.81603616e-06j,
 -0.12651058-1.98246210e-06j, -0.10208989-1.84178884e-06j,
 -0.08098543-1.29857249e-06j, -0.06261565-9.91431693e-07j,
 -0.04714385-7.72239719e-07j, -0.03372458-4.62789924e-07j,
 -0.02141267-3.31941066e-07j, -0.01121789-3.62177299e-08j])


nuc_wfn_lastv1 =  numpy.array([-1.05761155e-02+4.37976145e-24j, -2.95595786e-02-8.15936063e-06j,
 -5.20665110e-02-1.50050594e-05j, -7.71254282e-02-2.41835438e-05j,
 -1.05125994e-01-3.28850918e-05j, -1.35884706e-01-4.37652803e-05j,
 -1.70276662e-01-5.45065020e-05j, -2.08517703e-01-6.78487394e-05j,
 -2.50026653e-01-8.06679621e-05j, -2.95456954e-01-9.68555269e-05j,
 -3.45237999e-01-1.08945644e-04j, -3.98482643e-01-1.21933810e-04j,
 -4.54423727e-01-1.39863830e-04j, -5.12009818e-01-1.57428899e-04j,
 -5.71854867e-01-1.76034538e-04j, -6.33239564e-01-1.95030257e-04j,
 -6.94168819e-01-2.13777661e-04j, -7.54776388e-01-2.32834506e-04j,
 -8.14326594e-01-2.51224759e-04j, -8.71718107e-01-2.69424074e-04j,
 -9.25386355e-01-2.84374029e-04j, -9.75148418e-01-2.97898606e-04j,
 -1.02032034e+00-3.12165207e-04j, -1.06004098e+00-3.24149062e-04j,
 -1.09379652e+00-3.34635887e-04j, -1.12132501e+00-3.43261517e-04j,
 -1.14228038e+00-3.50230938e-04j, -1.15654865e+00-3.54598421e-04j,
 -1.16410443e+00-3.57046862e-04j, -1.16507950e+00-3.57315320e-04j,
 -1.15965520e+00-3.55767856e-04j, -1.14814666e+00-3.52205929e-04j,
 -1.13090436e+00-3.47066341e-04j, -1.10838566e+00-3.39994226e-04j,
 -1.08103590e+00-3.33151204e-04j, -1.04938951e+00-3.27087099e-04j,
 -1.01394054e+00-3.17328012e-04j, -9.75272657e-01-3.05173002e-04j,
 -9.33826405e-01-2.92266193e-04j, -8.90170348e-01-2.78686680e-04j,
 -8.44926903e-01-2.64532713e-04j, -7.98060642e-01-2.49986985e-04j,
 -7.49855017e-01-2.34872160e-04j, -7.01038538e-01-2.19748919e-04j,
 -6.51932350e-01-2.04314832e-04j, -6.02853548e-01-1.89154129e-04j,
 -5.53919810e-01-1.73715919e-04j, -5.05028325e-01-1.58697544e-04j,
 -4.56604198e-01-1.43277352e-04j, -4.08996255e-01-1.29213599e-04j,
 -3.62607294e-01-1.14752090e-04j, -3.17234091e-01-1.01919650e-04j,
 -2.73361563e-01-8.90882362e-05j, -2.31247198e-01-7.61575072e-05j,
 -1.90697574e-01-6.41402808e-05j, -1.50440940e-01-5.05221063e-05j,
 -1.11053197e-01-3.78694587e-05j, -7.29689570e-02-2.52002011e-05j,
 -3.65795830e-02-1.34599828e-05j, -3.70952697e-03-2.89889668e-06j,
  2.61681016e-02+5.02215986e-06j,  5.75052125e-02+1.32009653e-05j,
  8.89075387e-02+2.11092523e-05j,  1.20962855e-01+3.01417735e-05j,
  1.53920008e-01+3.97935141e-05j,  1.87686308e-01+4.85195216e-05j,
  2.22876769e-01+5.81614602e-05j,  2.59353878e-01+6.75709077e-05j,
  2.96672090e-01+7.80363656e-05j,  3.34648979e-01+8.61131821e-05j,
  3.73286444e-01+9.42038933e-05j,  4.12398744e-01+1.04568322e-04j,
  4.51639483e-01+1.14810246e-04j,  4.91134655e-01+1.25543050e-04j,
  5.30906380e-01+1.35620111e-04j,  5.70920751e-01+1.46051435e-04j,
  6.10479745e-01+1.56207041e-04j,  6.49520772e-01+1.66288092e-04j,
  6.88067595e-01+1.76282882e-04j,  7.25527028e-01+1.85845807e-04j,
  7.61565928e-01+1.95349700e-04j,  7.95949173e-01+2.03881680e-04j,
  8.28294720e-01+2.12949936e-04j,  8.57958033e-01+2.17062404e-04j,
  8.84436450e-01+2.19876240e-04j,  9.07433893e-01+2.26728612e-04j,
  9.26525448e-01+2.30601748e-04j,  9.41306592e-01+2.34507567e-04j,
  9.51440863e-01+2.36758949e-04j,  9.56559806e-01+2.38390520e-04j,
  9.56449773e-01+2.38137586e-04j,  9.50908814e-01+2.37071187e-04j,
  9.39860856e-01+2.34125886e-04j,  9.23263302e-01+2.30281094e-04j,
  9.01261883e-01+2.24618032e-04j,  8.74011177e-01+2.18119074e-04j,
  8.41728121e-01+2.09858945e-04j,  8.04899567e-01+2.01266002e-04j,
  7.63995159e-01+1.91272801e-04j,  7.19390010e-01+1.80270960e-04j,
  6.72225292e-01+1.68378261e-04j,  6.22977930e-01+1.56313536e-04j,
  5.72206747e-01+1.43354867e-04j,  5.20296594e-01+1.31655958e-04j,
  4.68901690e-01+1.19910662e-04j,  4.18820363e-01+1.06925475e-04j,
  3.70105283e-01+9.48069845e-05j,  3.23309234e-01+8.27896152e-05j,
  2.79406733e-01+7.18807514e-05j,  2.38241085e-01+6.12834734e-05j,
  2.00096479e-01+5.19189838e-05j,  1.65603154e-01+4.29405087e-05j,
  1.34449274e-01+3.55579450e-05j,  1.06927301e-01+2.82286911e-05j,
  8.24617314e-02+2.36555634e-05j,  6.06583558e-02+1.36153411e-05j,
  4.13052298e-02+6.18433165e-06j,  2.37965755e-02+5.37879035e-06j,
  8.20946921e-03+5.03371198e-06j, -7.39826845e-04+4.38673465e-06j])



nuc_density_normv0 = (nuc_wfn_lastv0)**2 / numpy.sum((nuc_wfn_lastv0)**2)

nuc_density_normv1 = (nuc_wfn_lastv1)**2 / numpy.sum((nuc_wfn_lastv1)**2)

# Fix v1 density (make two lobes have the same density)

v1_avg = (nuc_density_normv1[:60] + nuc_density_normv1[60:]) / 2
v1_avg = numpy.append(v1_avg, v1_avg)


plt.plot(HF_distance, nuc_density_normv0, 'go', HF_distance, nuc_density_normv0, 'g--', label='v0', color='darkred')
plt.plot(HF_distance, nuc_density_normv1, 'go', HF_distance, nuc_density_normv1, 'g--', label='v1', color='darkblue')
plt.plot(HF_distance, v1_avg, 'go', HF_distance, v1_avg, 'g--', label='v1', color='orange')
#plt.plot(HF_distance[1:-1], e_last[1:-1], 'go', HF_distance[1:-1], e_last[1:-1], 'g--', label='it_last', color='Red')
#plt.title('FHF v = 0 (2.60 a.u.) energy for UKS w/o microiterations')
plt.legend()
#plt.xlim((1.1, 1.7))
#plt.ylim((-198.84, -198.82))
plt.ylabel('Nuclear Density / au')
plt.xlabel('FH-Distance / a.u.')
plt.savefig('nuc_density.png')



