import matplotlib.pyplot as plt
import numpy
from pyscf import gto
from NECSCF.Nuclear import geom


mol=gto.Mole()
mol.atom = [['F',(0, 0, -1.1)],
            ['H',(0, 0, 0.0)],
            ['F',(0, 0, 1.1)]]
mol.basis = 'def2-SVP'
mol.charge = -1
mol.spin = 0
mol.build()

N = 100
NQ = 50
Q = geom.switch_geom(mol)
step = 0.004*1.88972612
v = 0
DisVector = numpy.array([[0.00000, 0.00000,  -1.00000],
                      [0.00000, 0.00000,  0.00000],
                      [0.00000, 0.00000,  1.00000]])

Geom_k = numpy.array(geom.geom_gen(Q, DisVector, N, NQ, step/1.88972612))
FF_distance = Geom_k[:, 2, 2] -  Geom_k[:, 0, 2]



e_bo =  numpy.array([-198.7572240, -198.76190612, -198.76643131, -198.77080402, -198.77502856,
 -198.77910909, -198.78304969, -198.78685427, -198.79052666, -198.79407055,
 -198.79748953, -198.80078709, -198.80396659, -198.80703131, -198.80998441,
 -198.81282898, -198.81556799, -198.81820434, -198.82074082, -198.82318017,
 -198.82552500, -198.82777789, -198.82994131, -198.83201767, -198.83400930,
 -198.83591849, -198.83774742, -198.83949824, -198.84117303, -198.84277380,
 -198.84430251, -198.84576107, -198.84715133, -198.84847510, -198.84973411,
 -198.85093007, -198.85206463, -198.85313939, -198.85415592, -198.85511574,
 -198.85602032, -198.85687111, -198.85766949, -198.85841684, -198.85911448,
 -198.85976370, -198.86036575, -198.86092187, -198.86143324, -198.86190104,
 -198.86232639, -198.86271040, -198.86305415, -198.86335869, -198.86362505,
 -198.86385422, -198.86404720, -198.86420493, -198.86432833, -198.86441833,
 -198.86447580, -198.86450160, -198.86449659, -198.86446158, -198.86439737,
 -198.86430476, -198.86418450, -198.86403733, -198.86386399, -198.86366519,
 -198.86344163, -198.86319397, -198.86292288, -198.86262900, -198.86231297,
 -198.86197541, -198.86161690, -198.86123804, -198.86083940, -198.86042155,
 -198.85998502, -198.85953036, -198.85905807, -198.85856868, -198.85806268,
 -198.85754055, -198.85700277, -198.85644980, -198.85588209, -198.85530007,
 -198.85470419, -198.85409485, -198.85347246, -198.85283742, -198.85219012,
 -198.85153094, -198.85086024, -198.85017839, -198.84948573, -198.84878261])



e_finalv0 =  numpy.array([-198.75723317, -198.76187361, -198.76636424, -198.77076437, -198.77499297,
 -198.77907929, -198.78304821, -198.78682098, -198.79045722, -198.79400222,
 -198.79746105, -198.80071812, -198.80393132, -198.80703719, -198.80991682,
 -198.81276010, -198.81553420, -198.81816857, -198.82070943, -198.82318286,
 -198.82549090, -198.82777234, -198.82990678, -198.83201393, -198.83398650,
 -198.83591941, -198.83773309, -198.83949889, -198.84117438, -198.84275329,
 -198.84429256, -198.84576313, -198.84714316, -198.84846758, -198.84972710,
 -198.85092353, -198.85205878, -198.85313397, -198.85415096, -198.85511153,
 -198.85601200, -198.85686799, -198.85766638, -198.85841724, -198.85910905,
 -198.85976164, -198.86036385, -198.86091831, -198.86143185, -198.86189841,
 -198.86232535, -198.86271051, -198.86305345, -198.86335878, -198.86362462,
 -198.86385389, -198.86404669, -198.86420478, -198.86432823, -198.86441833,
 -198.86447578, -198.86450160, -198.86449659, -198.86446157, -198.86439734,
 -198.86430469, -198.86418451, -198.86403716, -198.86386374, -198.86366487,
 -198.86344169, -198.86319343, -198.86292227, -198.86262910, -198.86231211,
 -198.86197440, -198.86161578, -198.86123527, -198.86083795, -198.86042175,
 -198.85998521, -198.85953059, -198.85905585, -198.85856620, -198.85806294,
 -198.85754084, -198.85700311, -198.85644655, -198.85587843, -198.85529631,
 -198.85470047, -198.85409514, -198.85346328, -198.85283805, -198.85218006,
 -198.85152403, -198.85085547, -198.85015322, -198.84947874, -198.84871958])




'''
plt.plot(FF_distance[1:-1], e_bo[1:-1], 'go', FF_distance[1:-1], e_bo[1:-1], 'g--', label='BO', color='Black')
plt.plot(FF_distance[1:-1], e_lastv0[1:-1], 'go', FF_distance[1:-1], e_lastv0[1:-1], 'g--', label='it_last', color='Red')
#plt.title('FFF v = 0 (2.60 a.u.) energy for UKS w/o microiterations')
plt.legend()
#plt.xlim((1.1, 1.5))
#plt.ylim((-198.85, -198.846))
plt.ylabel('Energy / au')
plt.xlabel('FH-Distance / a.u.')
plt.savefig('v0_energy260.png')
'''

plt.plot(FF_distance, e_bo, 'go', FF_distance, e_bo, 'g--', label='BO', color='Black')
plt.plot(FF_distance, e_finalv0, 'go', FF_distance, e_finalv0, 'g--', label='it_2last', color='Blue')
#plt.title('FFF v = 0 (2.60 a.u.) energy for UKS w/o microiterations')
plt.legend()
#plt.xlim((1.1, 1.7))
#plt.ylim((-198.84, -198.82))
plt.ylabel('Energy / au')
plt.xlabel('FF-Distance / a.u.')
plt.savefig('FF_PES.png')



#BO barrier = 0.0003723799999875155
#NECSCF-DFT barrier = 0.00036769000001868335

#NECSCF correction: -4.689999968832126e-06
